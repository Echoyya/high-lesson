## 当输入url时会做哪些事？ 前端浏览器渲染原理

### OSI 七层模型(open system interconnection) 理想状态下是七层模型

送快递：1）准备要发货的内容 2）打包 3）添加寄件信息 4）物流会再次打包 5）找到寄送的地址 6）找到对应的路 7） 拿车送过去

为什么要分层，可以将复杂的逻辑分成几个小的功能来处理 ，复杂的问题简单化。修改变得会比较容易

- 1.应用层 用户最终访问的接口
- 2.表示层 数据的表示形式、安全性 压缩等
- 3.会话层 建立和管理会话
- 4.传输层 因为网络层不可靠，保证可靠传输，需要用tcp （对数据的完整性保护） **主要提供安全及数据完整性的保障**
- 5.网络层 寻址进行寻址操作，通过ip找到对应的mac地址可以通信 （路由器） **主要关心寻址**
- 6.数据链路层 两个设备直接如何传递 建立逻辑连接的 mac地址 （交换机） 数据帧 **主要关心两个设备之间的传递数据**
- 7.物理层 网线 光纤来传递数据 双绞线 （0,1） 如何表现0.1  **主要关心如何传输信号**

下层是为了为上层提供服务的


## 实际应用时：
### TCP/IP 参考模型 五层模型，传输控制协议/网际协议
(物，数)：物理设备
网：
  - ARP协议：从ip地址获取Mac地址（局域网）
  - RARP协议:通信由mac地址通信，通过自己的mac地址，对方的ip 获取对方的mac地址
  - ip协议：寻址通过路由器查找，将消息发送给对方的路由器，通过ARP协议 发送自己的mac地址
传：TCP 、UDP
(会，表，应) ：HTTP FTP DNS

**协议就是对数据的封装和传输**

## DNS 域名服务器的查找机制：

1. dns：默认访问的是本地路由器分配到的dns 服务器，但是可以修改本地dns服务为其他服务器，例如 谷歌dns(8.8.8.8)  阿里114.114.114.114
因为谷歌用户访问量高，所有缓存较多，访问起来会比较快


www.baidu.com.cn 为例
2. 根服务器：访问一个域名时，dns服务器会先访问距离自己最近的根服务器，**获取到顶级域名 .cn 的Ip地址**,发送给谷歌dns，再由谷歌dns获取完整的域名，解析为对应的ip给用户并缓存，别人再次查找时，就可以走缓存了
3. 访问过程：会先通过**DNS服务器**查找距离自己最近的根服务器，通过根服务器找到 **.cn**服务器，将ip返回给`DNS服务器`，DNS服务器会继续向此ip发送请求，去查找对应`.cn`下`.com对应的ip`，获取最终的ip地址，缓存到DNS服务器上
4. 谷歌dns：除了有查找IP的作用，还可以做缓存机制，（域名：一层一层找，从后往前找）


## 传输层 TCP
1）TCP数据格式
- URG:紧急新号、ACK:确认信号、PSH:应该从TCP缓冲区读走数据、 RST：断开重新连接、SYN:建立连接、FIN:表示要断开

通过**wireshark抓包**，来分析网络底层协议

`三次握手`建立连接：中间的服务器应答和建立连接组成了一个包，三次握手保证
1. 我能主动给你打电话吗？ `Seq=0 `
2. 当然可以啊！那我也能给你打电话吗？`Seq=0 Ack=1`
3. 可以的呢，建立连接成功！`Seq=1 Ack=1`


`发送数据`：客=>服(len=14)   服=>客(len=12) 
`Seq=1  Ack=1 len=14`
`Seq=1  Ack=15`
`Seq=1  Ack=15 len=12`
`Seq=15  Ack=13`
> 连接和断开时:都是在对方的基础上+1,表示应答
> 传输时:客户端的Seq就是服务器端的ack，然后ack等于服务器端的seq+数据长度，记录传输的长度，服务器端同理，


`四次挥手`断开连接：当一方断开后，另一方有可能数据还没有发送完毕，所以无法将确认断开和真正的断开合并成一次
1. 我们分手吧 `Seq=15  Ack=13 `
2. 收到分手的信息(此时服务器可能还有会传输完的数据，等数据传输结束，就会断开连接)`Seq=13  Ack=16 `
3. 好吧，分就分吧`Seq=13  Ack=16 `
4. 行，那就到这里了`Seq=16  Ack=14 `